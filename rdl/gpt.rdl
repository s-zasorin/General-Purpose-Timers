addrmap CSR_GPT {
  default regwidth = 32;
    
  // Определяем регистры с адресами
  reg {
    field {
      name = "Активация счетчика";
      desc = "0: Счетчик неактивен<br><br>
              1: Счетчик активен";
      hw = rw;
      sw = rw;
    } CEN[1:1];
    field {
      name = "Запрет обновления";
      desc = "0: Событие обновления (UEV) может быть сгенерировано любым из способов: <br>
              [list] [*] Overflow/Underflow 
                     [*] Установка бита UG 
                     [*] Генерация обновления через контроллер ведомого режима [/list]
              1: UEV может быть сгенерировано только при Overflow/Underflow";
      hw = r;
      sw = rw;
    } URS[2:2];
    field {
      name = "Режим стробирования";
      desc = "0: Счетчик не останавливается при генерации события обновления UEV <br><br>
              1: При генерации события UEV бит CEN устанавливается в 0";
      hw = r;
      sw = rw;
    } OPM[3:3];
    field {
      name = "Направление счета";
      desc = "0: Счет вверх <br><br>
              1: Счет вниз  <br>";
      hw = r;
      sw = rw;
    } DIR[4:4];
    field {
      name = "Выбор режима центрового выравнивания";
      desc = "00: Счетчик считает вверх или вниз в зависимости от бита направления DIR<br>
              01: Счетчик считает по очереди вверх и вниз. Флаги прерывания сравнения счетчика CNT и CCR выставляются, когда счетчик считает вниз <br> 
              10: Счетчик считает по очереди вверх и вниз. Флаги прерывания сравнения счетчика CNT и CCR выставляются, когда счетчик считает вверх <br>
              11: Счетчик считает по очереди вверх и вниз. Флаги прерывания сравнения счетчика CNT и CCR выставляются, когда счетчик считает вверх и вниз";
      hw = rw;
      sw = rw;
    } CMS[6:5];
    field {
      name = "Разрешение предзагрузки";
      desc = "0:Теневой регистр ARR отключен — значение берется напрямую из регистра предварительной загрузки<br>
              1: Теневой регистр активен";
      hw = r;
      sw = rw;
    }APRE[7:7];
    field {
      name = "Коэффициент деления частоты цифрового фильтра";
      desc = "С помощью этого поля можно управлять формированием отфильтрованного сигнала с частотой F<sub>DTS</sub><br>,  
    00: F<sub>DTS</sub> = F<sub>INT</sub><br>  
    01: F<sub>DTS</sub> = F<sub>INT</sub>/2<br>  
    10: F<sub>DTS</sub> = F<sub>INT</sub>/4<br>  
    11: не используется  <br>";
      hw = r;
      sw = rw;
    }CKD[9:8];
  } TIM_CR1 @0x00;

reg {
  field {
    name = "Выбор T11";
    desc = "0: Вывод TIMx_CH1 подключен ко входу TI1<br>
            1: Выводы TIMx_CH1, CH2 и CH3 подключены ко входу TI1 (комбинация XOR)";
    hw = r;
    sw = rw;
} T11S[7:7];

field {
    name = "Выбор режима ведущего таймера";
    desc = "Эти биты позволяют выбрать информацию, передаваемую в режиме ведущего таймера для синхронизации ведомых таймеров (TRGO). Комбинации:<br>
            000: Сброс - бит UG из регистра TIMx_EGR используется как выход триггера (TRGO). Если сброс генерируется входом триггера (контроллер ведомого режима настроен в режиме сброса), то сигнал на TRGO задерживается относительно фактического сброса.<br>
            001: Разрешение - сигнал разрешения счетчика CNT_EN используется как выход триггера (TRGO). Полезно для одновременного запуска нескольких таймеров или управления окном, в котором разрешен ведомый таймер.<br>
            010: Обновление - Событие обновления выбрано как выход триггера (TRGO). Например, ведущий таймер может использоваться как предделитель для ведомого таймера.<br>
            011: Импульс сравнения - Выход триггера отправляет положительный импульс при установке флага CC11F (даже если он уже был высоким), как только происходит захват или совпадение сравнения.<br>
            100: Сравнение - Сигнал CC1REF используется как выход триггера (TRGO)<br>
            101: Сравнение - Сигнал CC2REF используется как выход триггера (TRGO)<br>
            110: Сравнение - Сигнал CC3REF используется как выход триггера (TRGO)<br>
            111: Сравнение - Сигнал CC4REF используется как выход триггера (TRGO)";
    hw = r;
    sw = rw;
} MMS[6:4];

field {
    name = "Выбор DMA для захвата/сравнения";
    desc = "0: Запрос DMA CCx отправляется при событии CCx<br>
            1: Запросы DMA CCx отправляются при событии обновления";
    hw = r;
    sw = rw;
} CCDS[3:3];

field {
    sw = r;
    hw = r;
} RESERVED_15_8[15:8] = 0;

field {
    sw = r;
    hw = r;
} RESERVED_2_0[2:0] = 0;
} TIM_CR2 @0x04;

reg {
  field {
    name = "Полярность внешнего триггера";
    desc = "Этот бит выбирает полярность сигнала ETR для операций триггера<br>
            0: ETR неинвертированный, активен по высокому уровню или фронту<br>
            1: ETR инвертированный, активен по низкому уровню или спаду";
    hw = r;
    sw = rw;
} ETP[15:15];

field {
    name = "Разрешение внешнего тактирования";
    desc = "Этот бит разрешает режим внешнего тактирования 2<br>
            0: Режим внешнего тактирования 2 запрещен<br>
            1: Режим внешнего тактирования 2 разрешен. Счетчик тактируется любым активным фронтом сигнала ETRF<br>
            <b>Примечание 1:</b> Установка бита ECE имеет тот же эффект, что и выбор внешнего тактирования 1 с подключением TRGI к ETRF (SMS=111 и TS=111)<br>
            <b>Примечание 2:</b> Возможно одновременное использование внешнего тактирования 2 со следующими ведомыми режимами: режим сброса, режим стробирования и режим триггера. Однако в этом случае TRGI не должен быть подключен к ETRF (биты TS не должны быть 111)<br>
            <b>Примечание 3:</b> Если одновременно разрешены внешний режим тактирования 1 и внешний режим тактирования 2, входом внешнего тактирования является ETRF";
    hw = r;
    sw = rw;
} ECE[14:14];

field {
    name = "Предделитель внешнего триггера";
    desc = "Частота сигнала внешнего триггера ETRP должна быть не более 1/4 частоты CK_INT. Предделитель может быть включен для уменьшения частоты ETRP. Это полезно при подаче быстрых внешних тактовых сигналов<br>
            00: Предделитель выключен<br>
            01: Частота ETRP делится на 2<br>
            10: Частота ETRP делится на 4<br>
            11: Частота ETRP делится на 8";
    hw = r;
    sw = rw;
} ETPS[13:12];

field {
    name = "Фильтр внешнего триггера";
    desc = "Эта битовая группа определяет частоту дискретизации сигнала ETRP и длину цифрового фильтра, применяемого к ETRP. Цифровой фильтр состоит из счетчика событий, в котором N последовательных событий необходимо для подтверждения перехода на выходе:<br>
            0000: Без фильтра, дискретизация на f<sub>DTS</sub><br>
            0001: f<sub>SAMPLING</sub> = f<sub>CK_INT</sub>, N=2<br>
            0010: f<sub>SAMPLING</sub> = f<sub>CK_INT</sub>, N=4<br>
            0011: f<sub>SAMPLING</sub> = f<sub>CK_INT</sub>, N=8<br>
            0100: f<sub>SAMPLING</sub> = f<sub>DTS</sub>/2, N=6<br>
            0101: f<sub>SAMPLING</sub> = f<sub>DTS</sub>/2, N=8<br>
            0110: f<sub>SAMPLING</sub> = f<sub>DTS</sub>/4, N=6<br>
            0111: f<sub>SAMPLING</sub> = f<sub>DTS</sub>/4, N=8<br>
            1000: f<sub>SAMPLING</sub> = f<sub>DTS</sub>/8, N=6<br>
            1001: f<sub>SAMPLING</sub> = f<sub>DTS</sub>/8, N=8<br>
            1010: f<sub>SAMPLING</sub> = f<sub>DTS</sub>/16, N=5<br>
            1011: f<sub>SAMPLING</sub> = f<sub>DTS</sub>/16, N=6<br>
            1100: f<sub>SAMPLING</sub> = f<sub>DTS</sub>/16, N=8<br>
            1101: f<sub>SAMPLING</sub> = f<sub>DTS</sub>/32, N=5<br>
            1110: f<sub>SAMPLING</sub> = f<sub>DTS</sub>/32, N=6<br>
            1111: f<sub>SAMPLING</sub> = f<sub>DTS</sub>/32, N=8";
    hw = r;
    sw = rw;
} ETF[11:8];

field {
    name = "Режим Ведущий/Ведомый";
    desc = "0: Никакого действия<br>
            1: Эффект события на входе триггера (TRGI) задерживается для обеспечения идеальной синхронизации между текущим таймером и его ведомыми (через TRGO). Полезно, если необходимо синхронизировать несколько таймеров по одному внешнему событию";
    hw = r;
    sw = rw;
} MSM[7:7];

field {
    name = "Выбор триггера";
    desc = "Эта битовая группа выбирает вход триггера для синхронизации счетчика:<br>
            000: Внутренний триггер 0 (ITR0)<br>
            001: Внутренний триггер 1 (ITR1)<br>
            010: Внутренний триггер 2 (ITR2)<br>
            011: Внутренний триггер 3 (ITR3)<br>
            100: Детектор фронтов T11 (T11F_ED)<br>
            101: Фильтрованный вход таймера 1 (T11FP1)<br>
            110: Фильтрованный вход таймера 2 (T12FP2)<br>
            111: Внешний вход триггера (ETRF)<br>
            <i>Примечание: Эти биты должны изменяться только когда они не используются (например, когда SMS=000) чтобы избежать некорректного детектирования фронтов во время перехода.</i>";
    hw = r;
    sw = rw;
} TS[6:4];

field {
    name = "Выбор ведомого режима";
    desc = "Когда выбраны внешние сигналы, активный фронт сигнала триггера (TRGI) связан с полярностью, выбранной на внешнем входе:<br>
            000: Ведомый режим отключен - если CEN = '1', то предделитель тактируется непосредственно от внутреннего тактового сигнала<br>
            001: Режим энкодера 1 - Счетчик считает вверх/вниз по фронту T11FP1 в зависимости от уровня T12FP2<br>
            010: Режим энкодера 2 - Счетчик считает вверх/вниз по фронту T12FP2 в зависимости от уровня T11FP1<br>
            011: Режим энкодера 3 - Счетчик считает вверх/вниз по обоим фронтам T11FP1 и T12FP2 в зависимости от уровня другого входа<br>
            100: Режим сброса - Фронт выбранного входа триггера (TRGI) переинициализирует счетчик и генерирует обновление регистров<br>
            101: Режим стробирования - Тактирование счетчика разрешено, когда вход триггера (TRGI) находится на высоком уровне. Счетчик останавливается (но не сбрасывается), как только триггер переходит на низкий уровень. Контролируются как запуск, так и остановка счетчика<br>
            110: Триггерный режим - Счетчик запускается по фронту триггера TRGI (но не сбрасывается). Контролируется только запуск счетчика<br>
            111: Режим внешнего тактирования 1 - Фронты выбранного триггера (TRGI) тактируют счетчик<br>
            <i>Примечание: Режим стробирования не должен использоваться, если выбран T11F_ED в качестве входа триггера (TS=100). Действительно, T11F_ED выдает 1 импульс для каждого перехода на T11F, тогда как режим стробирования проверяет уровень сигнала триггера.</i>";
    hw = r;
    sw = rw;
} SMS[2:0];

field {
    sw = r;
    hw = r;
} RESERVED[3:3] = 0;

} TIM_SMCR @0x08;

reg TIMx_DIER {
        name = "Регистр разрешения DMA/прерываний";
        desc = "Регистр разрешения DMA/прерываний TIMx";
        regwidth = 16;
        
        field {
            name = "UIE";
            desc = "Разрешение прерывания по обновлению";
            hw = rw;
            sw = rw;
        } UIE [0:0];
        
        field {
            name = "CC1IE";
            desc = "Разрешение прерывания захвата/сравнения 1";
            hw = rw;
            sw = rw;
        } CC1IE [1:1];
        
        field {
            name = "CC2IE";
            desc = "Разрешение прерывания захвата/сравнения 2";
            hw = rw;
            sw = rw;
        } CC2IE [2:2];
        
        field {
            name = "CC3IE";
            desc = "Разрешение прерывания захвата/сравнения 3";
            hw = rw;
            sw = rw;
        } CC3IE [3:3];
        
        field {
            name = "CC4IE";
            desc = "Разрешение прерывания захвата/сравнения 4";
            hw = rw;
            sw = rw;
        } CC4IE [4:4];
        
        field {
            name = "reserved_5";
            desc = "Зарезервирован, должен сохранять значение сброса";
            hw = r;
            sw = r;
            reset = 0;
        } reserved_5 [5:5];
        
        field {
            name = "TIE";
            desc = "Разрешение прерывания по триггеру";
            hw = rw;
            sw = rw;
        } TIE [6:6];
        
        field {
            name = "reserved_7";
            desc = "Зарезервирован, должен сохранять значение сброса";
            hw = r;
            sw = r;
            reset = 0;
        } reserved_7 [7:7];
        
        field {
            name = "UDE";
            desc = "Разрешение DMA запроса по обновлению";
            hw = rw;
            sw = rw;
        } UDE [8:8];
        
        field {
            name = "CC1DE";
            desc = "Разрешение DMA запроса захвата/сравнения 1";
            hw = rw;
            sw = rw;
        } CC1DE [9:9];
        
        field {
            name = "CC2DE";
            desc = "Разрешение DMA запроса захвата/сравнения 2";
            hw = rw;
            sw = rw;
        } CC2DE [10:10];
        
        field {
            name = "CC3DE";
            desc = "Разрешение DMA запроса захвата/сравнения 3";
            hw = rw;
            sw = rw;
        } CC3DE [11:11];
        
        field {
            name = "CC4DE";
            desc = "Разрешение DMA запроса захвата/сравнения 4";
            hw = rw;
            sw = rw;
        } CC4DE [12:12];
        
        field {
            name = "reserved_13";
            desc = "Зарезервирован, всегда читается как 0";
            hw = r;
            sw = r;
            reset = 0;
        } reserved_13 [13:13];
        
        field {
            name = "TDE";
            desc = "Разрешение DMA запроса по триггеру";
            hw = rw;
            sw = rw;
        } TDE [14:14];
        
        field {
            name = "reserved_15";
            desc = "Зарезервирован, должен сохранять значение сброса";
            hw = r;
            sw = r;
            reset = 0;
        } reserved_15 [15:15];
        
    } TIMx_DIER @ 0x0C;

reg TIMx_SR {
        name = "Status register";
        desc = "Регистр состояния";
        regwidth = 16;
        
        field {
            name = "reserved_15_13";
            desc = "Зарезервирован, должен сохранять значение сброса";
            hw = r;
            sw = r;
            reset = 0;
        } reserved_15_13 [15:13];
        
        field {
            name = "CC4OF";
            desc = "Флаг перезахвата Capture/Compare 4 - см. описание CC1OF";
            hw = rw;
            sw = rw;
        } CC4OF [12:12];
        
        field {
            name = "CC3OF";
            desc = "Флаг перезахвата Capture/Compare 3 - см. описание CC1OF";
            hw = rw;
            sw = rw;
        } CC3OF [11:11];
        
        field {
            name = "CC2OF";
            desc = "Флаг перезахвата Capture/Compare 2 - см. описание CC1OF";
            hw = rw;
            sw = rw;
        } CC2OF [10:10];
        
        field {
            name = "CC1OF";
            desc = "Флаг перезахвата Capture/Compare 1. Устанавливается аппаратно только когда соответствующий канал настроен в режиме захвата по входу. Сбрасывается программно записью '0'. 0: Перезахват не обнаружен; 1: Значение счетчика захвачено в регистр TIMx_CCR1 когда флаг CC1IF уже был установлен";
            hw = rw;
            sw = rw;
        } CC1OF [9:9];
        
        field {
            name = "reserved_8_7";
            desc = "Зарезервирован, должен сохранять значение сброса";
            hw = r;
            sw = r;
            reset = 0;
        } reserved_8_7 [8:7];
        
        field {
            name = "TIF";
            desc = "Флаг прерывания по триггеру. Устанавливается аппаратно при событии триггера (обнаружен активный фронт на входе TRGI когда контроллер ведомого режима включен во всех режимах кроме стробирующего). Устанавливается когда счетчик запускается или останавливается в стробирующем режиме. Сбрасывается программно. 0: Событие триггера не произошло; 1: Ожидает обработки прерывание по триггеру";
            hw = rw;
            sw = rw;
        } TIF [6:6];
        
        field {
            name = "reserved_5";
            desc = "Зарезервирован, должен сохранять значение сброса";
            hw = r;
            sw = r;
            reset = 0;
        } reserved_5 [5:5];
        
        field {
            name = "CC4IF";
            desc = "Флаг прерывания Capture/Compare 4 - см. описание CC1IF";
            hw = rw;
            sw = rw;
        } CC4IF [4:4];
        
        field {
            name = "CC3IF";
            desc = "Флаг прерывания Capture/Compare 3 - см. описание CC1IF";
            hw = rw;
            sw = rw;
        } CC3IF [3:3];
        
        field {
            name = "CC2IF";
            desc = "Флаг прерывания Capture/Compare 2 - см. описание CC1IF";
            hw = rw;
            sw = rw;
        } CC2IF [2:2];
        
        field {
            name = "CC1IF";
            desc = "Флаг прерывания Capture/Compare 1.<br> 
                  <b>Выход:<b> устанавливается аппаратно при совпадении счетчика со значением сравнения. Сбрасывается программно.<br>
                  0: Совпадения нет;<br>
                  1: CNT совпадает с CCR1. 
                  <b>Вход:<b> устанавливается аппаратно при захвате. Сбрасывается программно или чтением CCR1.<br>
                  0: Захват не произошел;<br>
                  1: Значение счетчика захвачено в CCR1";
            hw = rw;
            sw = rw;
        } CC1IF [1:1];
        
        field {
            name = "UIF";
            desc = "Флаг прерывания по обновлению. Устанавливается аппаратно при событии обновления. Сбрасывается программно. <br>
            0: Обновления не произошло;<br>
            1: Ожидает обработки прерывание по обновлению. Устанавливается при: переполнении/антипереполнении (TIM2-TIM5) если UDIS=0; переинициализации CNT программно (UG=1) если URS=0 и UDIS=0; переинициализации CNT событием триггера если URS=0 и UDIS=0";
            hw = rw;
            sw = rw;
        } UIF [0:0];
    } TIMx_SR @0x10;

reg TIMx_EGR {
        name = "Event generation register";
        desc = "Регистр генерации событий";
        regwidth = 16;
        
        field {
            name = "reserved_15_7";
            desc = "Зарезервирован, должен сохранять значение сброса";
            hw = r;
            sw = r;
            reset = 0;
        } reserved_15_7 [15:7];
        
        field {
            name = "TG";
            desc = "Генерация триггера. Устанавливается программно для генерации события, автоматически сбрасывается аппаратно.<br>
            0: Действия нет;<br>
            1: Флаг TIF устанавливается в регистре TIMx_SR. Соответствующее прерывание или передача DMA может произойти если разрешены";
            hw = rw;
            sw = rw;
        } TG [6:6];
        
        field {
            name = "reserved_5";
            desc = "Зарезервирован, должен сохранять значение сброса";
            hw = r;
            sw = r;
            reset = 0;
        } reserved_5 [5:5];
        
        field {
            name = "CC4G";
            desc = "Генерация Capture/Compare 4 - см. описание CC1G";
            hw = rw;
            sw = rw;
        } CC4G [4:4];
        
        field {
            name = "CC3G";
            desc = "Генерация Capture/Compare 3 - см. описание CC1G";
            hw = rw;
            sw = rw;
        } CC3G [3:3];
        
        field {
            name = "CC2G";
            desc = "Генерация Capture/Compare 2 - см. описание CC1G";
            hw = rw;
            sw = rw;
        } CC2G [2:2];
        
        field {
            name = "CC1G";
            desc = "Генерация Capture/Compare 1. Устанавливается программно для генерации события, автоматически сбрасывается аппаратно.<br>
            0: Действия нет;<br>
            1: Событие захвата/сравнения генерируется на канале 1. 
            <b>Выход:<b> флаг CC1IF устанавливается, отправляется соответствующее прерывание или запрос DMA если разрешены.<br>
            <b>Вход:<b> текущее значение счетчика захватывается в TIMx_CCR1, устанавливается флаг CC1IF, отправляется соответствующее прерывание или запрос DMA если разрешены, флаг CC1OF устанавливается если флаг CC1IF уже был установлен";
            hw = rw;
            sw = rw;
        } CC1G [1:1];
        
        field {
            name = "UG";
            desc = "Генерация обновления. Устанавливается программно, автоматически сбрасывается аппаратно.<br>
            0: Действия нет;<br>
            1: Реинициализирует счетчик и генерирует обновление регистров. Счетчик предделителя также сбрасывается (коэффициент предделителя не меняется). Счетчик очищается если выбран режим центрального выравнивания или если DIR=0 (счет вверх), иначе принимает значение авто-перезагрузки (TIMx_ARR) если DIR=1 (счет вниз)";
            hw = rw;
            sw = rw;
        } UG [0:0];
        
    } TIMx_EGR @ 0x14; // Типичный адрес для Event Generation Register

reg TIMx_CCMR1 {
  name = "Регистр режима захвата/сравнения 1";
  desc = "Каналы могут использоваться в режиме входа (захват) или в режиме выхода (сравнение). Направление канала определяется настройкой соответствующих битов CCxS. 
  Все остальные биты этого регистра имеют разную функцию в режиме входа и выхода. 
  OCxx описывает функцию бита когда канал настроен как выход, ICxx описывает функцию когда канал настроен как вход";
  field {
    name = "OC2CE/IC2F[3]";
    desc = "В зависимости от режима, в котором работает канал таймера (вход/выход) данное поле может быть:<br>
    <b>OC2CE<b> — Сигнал разрешение очистки выходного сигнала с помощью ETRF. <br>
    <b>IC2F[3]<b> — Старший бит поля, которое настраивает коэффициент фильтрации для цифрового фильтра на входе TI2.";
    hw = rw;
    sw = rw;
  } OC2CE_IC2F3[15:15];
  
  field {
    name = "OC2M/IC2F[2:0]";
    desc = "Данное поле может являться полем для настройки выходного сигнала (OC2M), либо являться младшей частью поля IC2F для настройки фильтра";
    hw = rw;
    sw = rw;
  } OC2M_IC2F[14:12];

  field {
    name = "OC2PE/IC2PSC[1]";
    desc = "Если это поле используется как OC2PE, то оно управляет включением или отключением предварительной загрузки регистра CCR2.
            Если канал работает в режиме входа, то это поле является старшим битом поля IC2PSC, которое настраивает коэффициент деления предделителя.";
    hw = rw;
    sw = rw;
  } OC2PE_IC2PSC1[11:11];

  field {
    name = "OC2FE/IC2PSC[0]";
    desc = "Это поле может быть полем OC2FE, с помощью которого можно включить режим быстрого формирования на выходе CC2 — Обычно нужно дождаться совадения CNT и CCR2, 
    но в этом режиме внешний триггер имеет такой же эффект, как и равенство CNT и CCR2, таким образом сигнал на выходе формируется намного быстрее.<br>
    <b>В другом случае<b> это поле может быть младшим битом поля IC2PSC.";
    hw = rw;
    sw = rw;
  } OC2FE_IC2PSC0[10:10];

  field {
    name = "CC2S";
    desc = "С помощью этого поля происход настройка канала в режим входа или выхода.<br>
    00: Канал 2 настроен как выход.<br>
    01: Канал 2 настроен как вход. Вход привязан к выводу TI2.<br>
    10: Канал 2 настроен как вход. Вход привязан к выводу TI1.<br>
    11: Канал 2 настроен как вход. Вход привязан к TRC.";
    hw = rw;
    sw = rw;
  } CC2S[9:8];

  field {
    name = "OC1CE/IC1F[3]";
    desc = "В зависимости от режима, в котором работает канал таймера (вход/выход) данное поле может быть:<br>
    <b>OC1CE<b> — Сигнал разрешение очистки выходного сигнала с помощью ETRF. <br>
    <b>IC1F[3]<b> — Старший бит поля, которое настраивает коэффициент фильтрации для цифрового фильтра на входе TI1.";
    hw = rw;
    sw = rw;
  } OC1CE_IC1F3[7:7];

  field {
    name = "OC1M/IC1F[2:0]";
    desc = "Данное поле может являться полем для настройки выходного сигнала (OC1M), либо являться младшей частью поля IC1F для настройки фильтра";
    hw = rw;
    sw = rw;
  } OC1M_IC1F[6:4];

  field {
    name = "OC1PE/IC1PSC[1]";
    desc = "Если это поле используется как OC1PE, то оно управляет включением или отключением предварительной загрузки регистра CCR1.
            Если канал работает в режиме входа, то это поле является старшим битом поля IC1PSC, которое настраивает коэффициент деления предделителя.";
    hw = rw;
    sw = rw;
  } OC1PE_IC1PSC1[3:3];

  field {
    name = "OC1FE/IC1PSC[0]";
    desc = "Это поле может быть полем OC1FE, с помощью которого можно включить режим быстрого формирования на выходе CC1 — Обычно нужно дождаться совадения CNT и CCR1, 
    но в этом режиме внешний триггер имеет такой же эффект, как и равенство CNT и CCR1, таким образом сигнал на выходе формируется намного быстрее.<br>
    <b>В другом случае<b> это поле может быть младшим битом поля IC1PSC.";
    hw = rw;
    sw = rw;
  } OC1FE_IC1PSC0[2:2];

  field {
    name = "CC1S";
    desc = "С помощью этого поля происход настройка канала в режим входа или выхода.<br>
    00: Канал 1 настроен как выход.<br>
    01: Канал 1 настроен как вход. Вход привязан к выводу TI1.<br>
    10: Канал 1 настроен как вход. Вход привязан к выводу TI1.<br>
    11: Канал 1 настроен как вход. Вход привязан к TRC.";
    hw = rw;
    sw = rw;
  } CC1S[1:0];
} TIMx_CCMR1 @0x18;

reg TIMx_CCER {
        name = "Capture/Compare enable register";
        desc = "Регистр разрешения захвата/сравнения";
        regwidth = 16;
        
        field {
            name = "CC4NP";
            desc = "Полярность выхода Capture/Compare 4 - см. описание CC1NP";
            hw = rw;
            sw = rw;
        } CC4NP [15:15];
        
        field {
            name = "reserved_14";
            desc = "Зарезервирован, должен сохранять значение сброса";
            hw = r;
            sw = r;
            reset = 0;
        } reserved_14 [14:14];
        
        field {
            name = "CC4P";
            desc = "Полярность выхода Capture/Compare 4 - см. описание CC1P";
            hw = rw;
            sw = rw;
        } CC4P [13:13];
        
        field {
            name = "CC4E";
            desc = "Разрешение выхода Capture/Compare 4 - см. описание CC1E";
            hw = rw;
            sw = rw;
        } CC4E [12:12];
        
        field {
            name = "CC3NP";
            desc = "Полярность выхода Capture/Compare 3 - см. описание CC1NP";
            hw = rw;
            sw = rw;
        } CC3NP [11:11];
        
        field {
            name = "reserved_10";
            desc = "Зарезервирован, должен сохранять значение сброса";
            hw = r;
            sw = r;
            reset = 0;
        } reserved_10 [10:10];
        
        field {
            name = "CC3P";
            desc = "Полярность выхода Capture/Compare 3 - см. описание CC1P";
            hw = rw;
            sw = rw;
        } CC3P [9:9];
        
        field {
            name = "CC3E";
            desc = "Разрешение выхода Capture/Compare 3 - см. описание CC1E";
            hw = rw;
            sw = rw;
        } CC3E [8:8];
        
        field {
            name = "CC2NP";
            desc = "Полярность выхода Capture/Compare 2 - см. описание CC1NP";
            hw = rw;
            sw = rw;
        } CC2NP [7:7];
        
        field {
            name = "reserved_6";
            desc = "Зарезервирован, должен сохранять значение сброса";
            hw = r;
            sw = r;
            reset = 0;
        } reserved_6 [6:6];
        
        field {
            name = "CC2P";
            desc = "Полярность выхода Capture/Compare 2 - см. описание CC1P";
            hw = rw;
            sw = rw;
        } CC2P [5:5];
        
        field {
            name = "CC2E";
            desc = "Разрешение выхода Capture/Compare 2 - см. описание CC1E";
            hw = rw;
            sw = rw;
        } CC2E [4:4];
        
        field {
            name = "CC1NP";
            desc = "Полярность выхода Capture/Compare 1. Выход: должен оставаться сброшенным. Вход: используется вместе с CC1P для определения полярности TI1FP1/TI2FP1. 00: неинвертированный/фронт rising; 01: инвертированный/фронт falling; 10: зарезервировано; 11: неинвертированный/оба фронта";
            hw = rw;
            sw = rw;
        } CC1NP [3:3];
        
        field {
            name = "reserved_2";
            desc = "Зарезервирован, должен сохранять значение сброса";
            hw = r;
            sw = r;
            reset = 0;
        } reserved_2 [2:2];
        
        field {
            name = "CC1P";
            desc = "Полярность выхода Capture/Compare 1. Выход: 0: OC1 активный высокий уровень; 1: OC1 активный низкий уровень. Вход: выбирает полярность TI1FP1 и TI2FP1 для операций триггера или захвата. 00: неинвертированный/rising edge; 01: инвертированный/falling edge; 10: зарезервировано; 11: неинвертированный/оба фронта";
            hw = rw;
            sw = rw;
        } CC1P [1:1];
        
        field {
            name = "CC1E";
            desc = "Разрешение выхода Capture/Compare 1. Выход: 0: Выключен - OC1 не активен; 1: Включен - сигнал OC1 выводится на соответствующий вывод. Вход: определяет возможен ли захват значения счетчика в регистр захвата/сравнения 1 (TIMx_CCR1). 0: Захват запрещен; 1: Захват разрешен";
            hw = rw;
            sw = rw;
        } CC1E [0:0];

    } TIMx_CCER @ 0x20; 

reg TIM_CNT {
  name = "Регистр основного счетчика";
  desc = "Счетчик разрядностью 32";
  field {
    name = "CNT";
    hw = rw;
    sw = rw;
  } CNT[31:0];
} TIM_CNT @ 0x24;

reg TIM_PSC {
  name = "Регистр предделителя";
  desc = "Данный регистр является Preload регистром для предделителя. Значение из этого регистра записывается в активный (теневой) регистр, когда происходит событие обновления
  (UEV).";
  field {
    name = "PSC";
    hw = rw;
    sw = rw;
  } PSC[31:0];
} TIM_PSC @0x28;

reg TIM_ARR {
  name = "Регистр автоматической перезагрузки";
  desc = "Данный регистр является Preload регистром для теневого регистра ARR.";
  field {
    name = "ARR";
    hw = rw;
    sw = rw;
  } ARR[31:0];
} TIM_ARR @0x2C;

reg TIM_CCR1 {
  name = "Регистр захвата/сравнения(минимум 2). Количество этих регистров может увеличиваться в зависимости от числа каналов.";
  field {
    name = "CCR1";
    hw = rw;
    sw = rw;
  } CCR1[31:0];
} TIM_CCR1 @0x34;

};

